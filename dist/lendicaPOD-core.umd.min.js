!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).LendicaPOD=t()}(this,(function(){"use strict";function e(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(a,o){var i=t.apply(n,r);function c(t){e(i,a,o,c,u,"next",t)}function u(t){e(i,a,o,c,u,"throw",t)}c(void 0)}))}}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r={type:"banner",compact:!1},a={link:"here at Lendica",before:"Thinking about expansion? Working capital available ",after:".",partnerSlug:null,prequalResult:null,referenceCode:null};return function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element="string"==typeof t?document.querySelector(t):t,this.config=n?Object.assign(r,n):r,this.initialized=!1,this.display=a,this.href="https://apply.golendica.com"}var o,i,c,u,s,l;return o=e,(i=[{key:"init",value:function(){this.initialized||this.loadData("http://127.0.0.1:8000/api/pod/content",{partnerDomain:"highpuritynaturalproducts.com",prequalData:this.config.prequal||null,underwritingData:this.config.underwrite||null})}},{key:"loadData",value:(l=t(regeneratorRuntime.mark((function e(t,n){var r,a,o,i,c,u,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new Headers).append("Content-Type","application/json"),a=crypto.getRandomValues(new Uint8Array(12)),e.next=5,this.generateAES();case 5:return o=e.sent,e.t0=console,e.next=9,crypto.subtle.exportKey("raw",o);case 9:return e.t1=e.sent,e.t0.log.call(e.t0,e.t1),e.t2=console,e.next=14,crypto.subtle.exportKey("jwk",o);case 14:return e.t3=e.sent,e.t2.log.call(e.t2,e.t3),e.next=18,this.encryptJson({name:"AES-GCM",iv:a},o,n);case 18:return i=e.sent,console.log(i),e.next=22,this.decryptJson({name:"AES-GCM",iv:a},o,i);case 22:return c=e.sent,console.log(c),e.prev=24,e.next=27,fetch(t,{method:"POST",headers:r,body:JSON.stringify(n)});case 27:if((u=e.sent).ok){e.next=31;break}return console.warn("Something went wrong :/. Status code: "+u.status),e.abrupt("return");case 31:u.json().then((function(e){return e})).then((function(e){return Object.assign(s.display,e),!0})).then((function(e){s.element.appendChild(s.composeContent(s.display)),s.element.className+=s.config.color?" ".concat(s.config.color):" default",s.config.compact&&(s.element.firstChild.className+=" lendica-finance-compact"),s.config.animation&&(s.element.className+=" ribbon-drop",s.element.firstChild.className+=" animate-background",s.element.firstChild.firstChild.className+="animate-color"),s.initialized=!0})),e.next=37;break;case 34:e.prev=34,e.t4=e.catch(24),console.warn("Unable to update LendicaPOD data. "+e.t4);case 37:case"end":return e.stop()}}),e,this,[[24,34]])}))),function(e,t){return l.apply(this,arguments)})},{key:"composeContent",value:function(){var e=this.display,t=e.link,n=e.before,r=e.after,a=e.partnerSlug,o=e.prequalResult,i=e.referenceCode;a&&(this.href="https://apply.golendica.com/".concat(this.display.partnerSlug)),this.config.query&&(this.href+="/portal".concat(this.querify(this.config.query))),i&&(this.href+="&reference=".concat(encodeURIComponent(i)));var c=document.createElement("div");c.className+="lendica-finance-content-wrapper";var u=document.createElement("span"),s=document.createElement("a");return s.textContent=t,s.href=this.href,s.setAttribute("target","_blank"),s.setAttribute("rel","noopener noreferrer"),o&&n.replace("[INSERT]",this.getCurrency(o)),u.appendChild(document.createTextNode(n)),u.appendChild(s),u.appendChild(document.createTextNode(r)),u.normalize(),c.appendChild(u),c}},{key:"querify",value:function(e){if(e&&e instanceof Object)return"?"+Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&");console.warn("Invalid or empty query data. Expected object with key value pairs.")}},{key:"encryptJson",value:(s=t(regeneratorRuntime.mark((function e(t,n,r){var a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.getMessageEncoding(JSON.stringify(r)),e.next=3,crypto.subtle.encrypt(t,n,a);case 3:return o=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"decryptJson",value:(u=t(regeneratorRuntime.mark((function e(t,n,r){var a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,crypto.subtle.decrypt(t,n,r);case 2:return a=e.sent,o=new TextDecoder,e.abrupt("return",JSON.parse(o.decode(a)));case 5:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"getMessageEncoding",value:function(e){return(new TextEncoder).encode(e)}},{key:"generateAES",value:function(){return crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}},{key:"generateRSA",value:function(){return crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:4096,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"])}},{key:"getCurrency",value:function(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}}])&&n(o.prototype,i),c&&n(o,c),e}()}));
